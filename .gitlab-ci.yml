stages:
  - setup
  - push  

print_git_version:
  stage: setup
  script:
    - echo "Checking Git version..."
    - git --version

push_to_github:
  stage: push
  only:
    - main 
  script:
    - 'which ssh-agent || ( apt-get update -y && apt-get install openssh-client -y )'
    - eval $(ssh-agent -s)
    - echo "$GITHUB_SSH_PRIVATE_KEY" | tr -d '\r' | ssh-add - > /dev/null
    - mkdir -p ~/.ssh
    - chmod 700 ~/.ssh
    - ssh-keyscan github.com >> ~/.ssh/known_hosts
    - chmod 644 ~/.ssh/known_hosts
    - git remote | grep -q github || git remote add github git@github.com:shadyemansour/infoVis.git
    - git push github HEAD:main --force